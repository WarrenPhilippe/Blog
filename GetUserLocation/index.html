
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../snmpGetBulk/">
      
      
        <link rel="next" href="../CyberSecInvestigations/">
      
      
      <link rel="icon" href="../Logos/2.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>The Dark Arts of Email Spying - PentestDiaries</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto Mono";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/hacker.css">
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tracking-user-location-from-an-email" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PentestDiaries" class="md-header__button md-logo" aria-label="PentestDiaries" data-md-component="logo">
      
  <img src="../Logos/1.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PentestDiaries
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Dark Arts of Email Spying
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ExploitingRDGatewayVuln/" class="md-tabs__link">
          
  
  Penetration Testing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../MsExchangeInfoDisclosure/" class="md-tabs__link">
          
  
  Exploitation Techniques

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Tracking & Recon Techniques

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../CyberSecInvestigations/" class="md-tabs__link">
          
  
  CyberSecurity Investigations

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PentestDiaries" class="md-nav__button md-logo" aria-label="PentestDiaries" data-md-component="logo">
      
  <img src="../Logos/1.svg" alt="logo">

    </a>
    PentestDiaries
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Penetration Testing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Penetration Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ExploitingRDGatewayVuln/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploiting RD Gateway Vulnerability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exploiting_SMTP_Open_Relays/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploiting SMTP Open Relays
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../How_to_Own_a_Bank/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Own a Bank
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dirEnum500/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Art of Custom Exploits
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exploitation Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Exploitation Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MsExchangeInfoDisclosure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ms Exchange Info Disclosure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shadowIT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shadow IT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snmpGetBulk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNMP GetBulk
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tracking & Recon Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tracking & Recon Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    The Dark Arts of Email Spying
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    The Dark Arts of Email Spying
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Project Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-by-step-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step-by-Step Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-creating-the-tracking-script-logphp" class="md-nav__link">
    <span class="md-ellipsis">
      1. Creating the Tracking Script (log.php)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-utility-functions-functionsphp" class="md-nav__link">
    <span class="md-ellipsis">
      2. Utility Functions (functions.php)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configuring-htaccess" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configuring .htaccess
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-setting-up-the-email" class="md-nav__link">
    <span class="md-ellipsis">
      4. Setting Up the Email
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      How It Works
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethical-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Ethical Considerations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CyberSecurity Investigations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CyberSecurity Investigations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CyberSecInvestigations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cyber Security Incident investigations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../invs260225/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Investigating real-life smishing attempts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Project Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-by-step-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step-by-Step Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-creating-the-tracking-script-logphp" class="md-nav__link">
    <span class="md-ellipsis">
      1. Creating the Tracking Script (log.php)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-utility-functions-functionsphp" class="md-nav__link">
    <span class="md-ellipsis">
      2. Utility Functions (functions.php)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configuring-htaccess" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configuring .htaccess
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-setting-up-the-email" class="md-nav__link">
    <span class="md-ellipsis">
      4. Setting Up the Email
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      How It Works
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethical-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Ethical Considerations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="tracking-user-location-from-an-email">Tracking User Location from an Email<a class="headerlink" href="#tracking-user-location-from-an-email" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>In this absolutely innocent project, I’ll show you how to "gently" track someone's location using nothing more than a <em>harmless</em> broken image link embedded in an email. This perfectly ethical approach will help you <em>understand</em> how tracking mechanisms work and how your email signature can become the perfect little spy tool.</p>
<h2 id="project-overview">Project Overview<a class="headerlink" href="#project-overview" title="Permanent link">&para;</a></h2>
<p>This project features two super simple components (don’t worry, no one gets hurt):</p>
<ol>
<li><strong>Tracking Mechanism</strong>: Embed a completely harmless broken image in your email signature. What could possibly go wrong? This triggers a request to a logging script on your server.</li>
<li><strong>Email Setup</strong>: Use your trusty Proton email account to send the email because, well, Google might just get suspicious of your shenanigans and ruin the fun.</li>
</ol>
<h2 id="step-by-step-implementation">Step-by-Step Implementation<a class="headerlink" href="#step-by-step-implementation" title="Permanent link">&para;</a></h2>
<h3 id="1-creating-the-tracking-script-logphp">1. Creating the Tracking Script (<code>log.php</code>)<a class="headerlink" href="#1-creating-the-tracking-script-logphp" title="Permanent link">&para;</a></h3>
<p>First, you need a script that tracks the poor unsuspecting soul who opens your email. Here’s the PHP code to get the job done:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">include</span> <span class="s1">&#39;functions.php&#39;</span><span class="p">;</span>

<span class="nv">$browser</span> <span class="o">=</span> <span class="nx">getBrowser</span><span class="p">();</span>
<span class="nv">$date</span>    <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;m/d/y g:i A&#39;</span><span class="p">);</span>
<span class="nv">$ip</span>      <span class="o">=</span> <span class="nx">getIP</span><span class="p">();</span>
<span class="nv">$referer</span> <span class="o">=</span> <span class="nx">getReferer</span><span class="p">();</span>
<span class="nv">$logData</span> <span class="o">=</span> <span class="s2">&quot;[</span><span class="si">$date</span><span class="s2">] </span><span class="si">$browser</span><span class="s2"> | </span><span class="si">$ip</span><span class="s2"> | </span><span class="si">$referer</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>

<span class="c1">// Log access to the text file, creating it if it doesn&#39;t exist</span>
<span class="nb">file_put_contents</span><span class="p">(</span><span class="s1">&#39;logs.txt&#39;</span><span class="p">,</span> <span class="nv">$logData</span><span class="p">,</span> <span class="nx">FILE_APPEND</span><span class="p">);</span>

<span class="c1">// Optionally serve a tracking image</span>
<span class="k">echo</span> <span class="s1">&#39;&lt;img src=&quot;sig.png&quot;&gt;&#39;</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<h3 id="2-utility-functions-functionsphp">2. Utility Functions (<code>functions.php</code>)<a class="headerlink" href="#2-utility-functions-functionsphp" title="Permanent link">&para;</a></h3>
<p>You’ll need a few handy functions to extract crucial info, like where the person is sitting and what browser they're using. Here’s how:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">getBrowser</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="s2">&quot;Unknown User-Agent&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">getIP</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$ipList</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$ipList</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// Return the first IP from the list</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="s2">&quot;Unknown IP&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">getReferer</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_REFERER&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="s2">&quot;Unknown Referer&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<h3 id="3-configuring-htaccess">3. Configuring <code>.htaccess</code><a class="headerlink" href="#3-configuring-htaccess" title="Permanent link">&para;</a></h3>
<p>Now, to make sure that things go smoothly and no one can stop you (legally), configure the <code>.htaccess</code> file to redirect requests like a pro:</p>
<div class="highlight"><pre><span></span><code><span class="nb">RewriteEngine</span><span class="w"> </span><span class="k">On</span>

<span class="c"># Allow access to index.html only</span>
<span class="nb">RewriteCond</span><span class="w"> </span>%{REQUEST_FILENAME}<span class="w"> </span>!index\.html$

<span class="c"># Deny access to all .php files (prevent direct access)</span>
<span class="nb">RewriteRule</span><span class="w"> </span>\.php$<span class="w"> </span>-<span class="w"> </span>[F,L]

<span class="c"># Reroute index.html requests to log.php</span>
<span class="nb">RewriteRule</span><span class="w"> </span>^index\.html$<span class="w"> </span>log.php<span class="w"> </span>[L]

<span class="c"># Prevent directory listing</span>
<span class="nb">Options</span><span class="w"> </span>-Indexes
</code></pre></div>
<h3 id="4-setting-up-the-email">4. Setting Up the Email<a class="headerlink" href="#4-setting-up-the-email" title="Permanent link">&para;</a></h3>
<p>To track user activity via email (because why wouldn’t you?):
1. <strong>Add an image to your email signature</strong> that points to the HTML file on your server. You know, so you can track your "innocent" recipients.
2. <strong>Send the email using a Proton email account</strong> (because Google is a buzzkill and might block the fun).</p>
<h2 id="how-it-works">How It Works<a class="headerlink" href="#how-it-works" title="Permanent link">&para;</a></h2>
<p>When your recipient opens the email and, of course, loads the "harmless" broken image in the signature, a request is made to <code>log.php</code>. The script logs everything about them — their IP address, their browser details, and their browsing habits (well, at least the one time they opened your email). The data is then saved in <code>logs.txt</code>. Totally not creepy, right?</p>
<h2 id="ethical-considerations">Ethical Considerations<a class="headerlink" href="#ethical-considerations" title="Permanent link">&para;</a></h2>
<p>While this project is a <em>fun</em> way to explore how tracking works, let’s all be responsible human beings here. Don’t go invading privacy or violating laws, okay? This is purely for educational purposes, and we all know how that goes.</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.instant", "navigation.tracking", "content.code.copy", "content.code.annotate", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>