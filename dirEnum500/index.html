
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../How_to_Own_a_Bank/">
      
      
        <link rel="next" href="../MsExchangeInfoDisclosure/">
      
      
      <link rel="icon" href="../Logos/2.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>The Art of Custom Exploits - PentestDiaries</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto Mono";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/hacker.css">
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-2-retrieving-session-id-and-csrf-token" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PentestDiaries" class="md-header__button md-logo" aria-label="PentestDiaries" data-md-component="logo">
      
  <img src="../Logos/1.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PentestDiaries
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Art of Custom Exploits
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ExploitingRDGatewayVuln/" class="md-tabs__link">
          
  
  Penetration Testing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../MsExchangeInfoDisclosure/" class="md-tabs__link">
          
  
  Exploitation Techniques

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../GetUserLocation/" class="md-tabs__link">
          
  
  Tracking & Recon Techniques

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../CyberSecInvestigations/" class="md-tabs__link">
        
  
    
  
  CyberSecurity Investigations

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PentestDiaries" class="md-nav__button md-logo" aria-label="PentestDiaries" data-md-component="logo">
      
  <img src="../Logos/1.svg" alt="logo">

    </a>
    PentestDiaries
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Penetration Testing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Penetration Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ExploitingRDGatewayVuln/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploiting RD Gateway Vulnerability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exploiting_SMTP_Open_Relays/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploiting SMTP Open Relays
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../How_to_Own_a_Bank/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Own a Bank
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    The Art of Custom Exploits
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    The Art of Custom Exploits
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-2-retrieving-session-id-and-csrf-token" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Retrieving Session ID and CSRF Token
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-checking-directory-existence" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Checking Directory Existence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-bringing-it-all-together-the-main-function" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Bringing It All Together - The Main Function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion-the-power-of-misconfigurations" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion: The Power of Misconfigurations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exploitation Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Exploitation Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MsExchangeInfoDisclosure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ms Exchange Info Disclosure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shadowIT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shadow IT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snmpGetBulk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNMP GetBulk
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tracking & Recon Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tracking & Recon Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GetUserLocation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Dark Arts of Email Spying
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CyberSecInvestigations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CyberSecurity Investigations
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-2-retrieving-session-id-and-csrf-token" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Retrieving Session ID and CSRF Token
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-checking-directory-existence" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Checking Directory Existence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-bringing-it-all-together-the-main-function" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Bringing It All Together - The Main Function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion-the-power-of-misconfigurations" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion: The Power of Misconfigurations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>The Art of Custom Exploits</h1>

<p>Here's a funny and sarcastic take on your blog post:</p>
<p><div class="highlight"><pre><span></span><code><span class="gh"># Directory Enumeration: Unveiling Hidden Paths Through Error Message Misconfiguration</span>

Ah, the sweet joy of navigating web applications—kind of like a treasure hunt, but with a lot more frustration and a few <span class="ge">*potential*</span> security issues along the way. Recently, while doing my usual routine of poking around a web app during a penetration test, I encountered an intriguing challenge. The app was so smart that it redirected all unauthorized requests to a login page, effectively locking me out of any useful paths. And as if that wasn’t enough, it had DarkTrace—a fancy, state-of-the-art IDS/IPS—lurking in the background like a digital watchdog. 

But hey, I’ve been around long enough to know that even the most sophisticated defense can have its little cracks. This &quot;impenetrable&quot; login redirection? Yeah, it wasn’t nearly enough to keep me from uncovering valuable directory information. Thanks to some <span class="ge">*subtle*</span> misconfigurations in error messages, I was able to do a little detective work and expose the hidden directories. So, let&#39;s dive in!

<span class="gu">## The Strategy: Harnessing POST Requests and Error Codes</span>

So, this login redirect wasn’t just annoying—it was a redirection nightmare, throwing 302 status codes at me for every unauthorized request. The trick? You could just throw GET requests all day, and it would be like playing fetch with a brick wall. But guess what? I had other plans. Rather than repeatedly running into that 302 brick wall, I decided to mix things up with POST requests aimed at some known (or at least highly suspected) directory paths.

The real genius here was that these POST requests would bypass the redirect and, instead, trigger lovely, juicy error codes. This way, I could get more info than I ever could with a simple GET.

<span class="gu">### The HTTP Status Codes That Matter</span>

Let’s break it down for the uninitiated. Here are the HTTP status codes that practically begged me to explore further:

<span class="k">-</span><span class="w"> </span><span class="gs">**200 OK**</span>: A valid directory exists. Finally, success! It’s like finding the key to the treasure chest.
<span class="k">-</span><span class="w"> </span><span class="gs">**302 Redirect**</span>: Oops! Directory doesn’t exist, but at least I’m getting redirected back to the login page. How nice of it.
<span class="k">-</span><span class="w"> </span><span class="gs">**403 Forbidden**</span>: Oh, so the directory exists, but I’m <span class="ge">*not*</span> allowed to see it? Classic. Time to dig a little deeper.
<span class="k">-</span><span class="w"> </span><span class="gs">**500 Internal Server Error**</span>: Triggering a 500 error means I’ve either broken something or the server is just being a drama queen. Either way, valuable intel!

With this strategy locked in, I whipped up a Python script to handle all the tedious checking for me.

<span class="gu">## The Code: A Closer Look</span>

<span class="gu">### Step 1: Setting the Stage: Imports and Functions</span>

Here’s how you begin:

```python
import requests
import sys
import re
</code></pre></div>
- <strong>requests</strong>: Because who doesn't love making HTTP calls and pretending to be a browser?
- <strong>sys</strong>: For handling those lovely command-line arguments we all adore.
- <strong>re</strong>: You know, for when you need to pull out the juicy bits from raw HTML.</p>
<h3 id="step-2-retrieving-session-id-and-csrf-token">Step 2: Retrieving Session ID and CSRF Token<a class="headerlink" href="#step-2-retrieving-session-id-and-csrf-token" title="Permanent link">&para;</a></h3>
<p>To be fair, the first thing you need to do is grab the session ID and CSRF token, because web apps <em>love</em> that stuff for security. Here’s how it goes down:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_session_id_and_csrf_token</span><span class="p">(</span><span class="n">base_url</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">session_id</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;JSESSIONID&#39;</span><span class="p">)</span>

        <span class="n">csrf_token_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;name=&quot;_csrf&quot; value=&quot;([^&quot;]+)&quot;&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">csrf_token</span> <span class="o">=</span> <span class="n">csrf_token_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">csrf_token_match</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">session_id</span> <span class="ow">and</span> <span class="n">csrf_token</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] Retrieved session ID: </span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] Retrieved CSRF token: </span><span class="si">{</span><span class="n">csrf_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">csrf_token</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[ERROR] Session ID or CSRF token not found.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ERROR] Failed to retrieve session ID and CSRF token: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
This part is like unlocking the front door with a shiny key.</p>
<h3 id="step-3-checking-directory-existence">Step 3: Checking Directory Existence<a class="headerlink" href="#step-3-checking-directory-existence" title="Permanent link">&para;</a></h3>
<p>Once you have your session cookie and CSRF token (because who doesn’t want to pretend to be authenticated), it’s time to check those directories. I mean, why not?</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_directory</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">csrf_token</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># Headers mimicking a real browser</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;username=test&amp;password=gahjkldsa&amp;_csrf=</span><span class="si">{</span><span class="n">csrf_token</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
Here we simulate a login with some fake creds. No big deal. Just testing the waters, you know?</p>
<h3 id="step-4-bringing-it-all-together-the-main-function">Step 4: Bringing It All Together - The Main Function<a class="headerlink" href="#step-4-bringing-it-all-together-the-main-function" title="Permanent link">&para;</a></h3>
<p>Finally, you bring it all together with the main function, which does all the dirty work and checks the directories for you:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage: python3 script.py &lt;directory_file&gt;&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Read directories from the specified file and check each one</span>
</code></pre></div>
Don’t worry, it’s flexible. You can just throw a file with directories at it, and voilà, results.</p>
<h2 id="conclusion-the-power-of-misconfigurations">Conclusion: The Power of Misconfigurations<a class="headerlink" href="#conclusion-the-power-of-misconfigurations" title="Permanent link">&para;</a></h2>
<p>In the end, it's clear: even the most "secure" applications have cracks you can slip through. By exploiting some misconfigured error messages and strategically crafting requests, I was able to uncover hidden directories in a web app that thought it had all the bases covered. This isn't just about finding secret paths; it's about understanding how systems fail and how we can exploit those failures—responsibly, of course.</p>
<p>Let this be a reminder to all of us: no matter how fancy your security system is, there's always a little misstep that could open the door to the treasure chest. And let’s be honest, there’s always more treasure to find.</p>
<hr />
<p>```</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.instant", "navigation.tracking", "content.code.copy", "content.code.annotate", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>